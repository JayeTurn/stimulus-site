{% include head.html %}
<body class="{% if page.class %} {{ page.class }}{% endif %}">
  {% include navigation.html %}

  <main id="content" class="handbook">
    <section class="handbook__index">

      <input type="checkbox" id="hamburger" class="handbook__checkbox"/>
      <label class="handbook__mobile-button" for="hamburger"><span></span> Table of Contents</label>

      <nav class="handbook__nav">
        <label class="handbook__mobile-button handbook__mobile-button--close" for="hamburger"><span></span> close</label>

        {%- assign groups = site.pages | group_by: "nav_group" | where_exp: "group","group.name != ''" -%}
        {%- for group in groups -%}
          <p class="handbook__nav-title handbook__nav-title--{{ group.name }}">{{ group.name | capitalize }}:</p>
          <ul class="handbook__nav-list handbook__nav-list--{{ group.name }}">
            {%- assign items = group.items | sort: "nav_order" -%}
            {%- for item in items -%}
              {%- assign is_active = false -%}
              {%- if page.url == item.url -%}
                {%- assign is_active = true -%}
                {%- assign next_item = items[forloop.index] -%}
              {%- endif -%}
              <li>
                <a class="handbook__nav-link{% if is_active %} active{% endif %}" href="{{ item.url }}">
                  {%- assign prefix = item.nav_prefix -%}
                  {%- unless prefix -%}
                    {%- assign index = item.path | split: "/" | reverse | first | abs -%}
                    {%- if index > 0 -%}
                      {%- assign prefix = forloop.index0 -%}
                    {%- endif -%}
                  {%- endunless -%}
                  {%- if prefix %}{{ prefix }}: {% endif %}{{ item.title }}
                </a>
              </li>
            {%- endfor -%}
          </ul>
        {%- endfor -%}
      </nav>
    </section>

    <section id="start" class="handbook__content" data-controller="anchor" data-anchor-selector="h2,h3,h4">
      {{ content }}

      {% if next_item %}
        <p>Next: <a href="{{ next_item.url }}">{{ next_item.title }}</a></p>
      {% endif %}
    </section>
  </main>

  {% include footer.html %}
</body>
</html>
